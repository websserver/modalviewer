<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>IQOS ILUMA i PRIME</title>
    <link rel="icon" type="image/x-icon" href="logo/favicon.ico">
    
    <!-- Model Viewer -->
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
    
    <!-- Estilos -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Modal de Verificação de Idade -->
    <div class="age-verification-modal" id="ageVerificationModal">
        <div class="age-verification-content">
            <svg xmlns="http://www.w3.org/2000/svg" width="168" height="52" viewBox="0 0 168 52" class="age-verification-logo">
                <title>IQOS</title>
                <g fill="none" fill-rule="evenodd">
                    <g fill="#34303D" fill-rule="nonzero">
                        <g>
                            <path d="M40.981 7.814l5.957 10.372 5.956 10.372c2.996 5.221 2.613 11.073 0 15.628C50.282 48.741 45.405 52 39.414 52H15.586c-5.992 0-10.834-3.259-13.481-7.814-2.613-4.555-2.996-10.442 0-15.628l5.956-10.372L14.02 7.814C17.015 2.593 22.24 0 27.5 0s10.485 2.593 13.481 7.814M27.5 9.04c-5.608 0-10.694 2.278-14.387 5.992-3.692 3.715-5.956 8.83-5.956 14.472 0 5.642 2.264 10.757 5.956 14.472 3.693 3.714 8.779 5.992 14.387 5.992 5.608 0 10.694-2.278 14.387-5.992 3.692-3.715 5.956-8.83 5.956-14.472 0-5.641-2.264-10.757-5.956-14.472C38.194 11.318 33.143 9.04 27.5 9.04M129.5 18.13c1.095 0 2.052.138 2.907.382.855.243 1.573.626 2.12 1.078.444.382.752.8.992 1.286.205.487.341 1.009.341 1.6v6.189c0 .59-.102 1.112-.341 1.6-.206.486-.548.903-.992 1.286-.547.487-1.265.834-2.12 1.078-.855.243-1.812.382-2.906.382h-8.274c-1.094 0-2.052-.139-2.907-.382-.854-.244-1.572-.626-2.12-1.078-.444-.383-.752-.8-.991-1.287-.24-.487-.342-1.008-.342-1.6v-6.188c0-.591.103-1.113.342-1.6.205-.487.547-.904.992-1.286.547-.487 1.265-.835 2.12-1.078.854-.244 1.812-.383 2.906-.383h8.274m0-3.094h-8.274c-3.043 0-5.403.834-6.975 2.19-1.573 1.356-2.394 3.234-2.394 5.285v6.19c0 2.051.82 3.929 2.394 5.285 1.572 1.356 3.932 2.19 6.975 2.19h8.274c3.043 0 5.402-.834 6.975-2.19 1.573-1.356 2.393-3.234 2.393-5.285v-6.19c0-2.051-.82-3.929-2.393-5.285-1.573-1.356-3.932-2.19-6.975-2.19m-23.865 18.567c-.171-.174-.41-.347-.65-.452-.24-.104-.513-.139-.752-.139H89.053c-1.094 0-2.052-.139-2.906-.382-.855-.244-1.573-.626-2.12-1.078-.445-.383-.752-.8-.992-1.287-.205-.487-.342-1.008-.342-1.6V18.582c0-.104.035-.243.137-.313.068-.07.171-.139.308-.139H97.293c1.094 0 2.051.14 2.906.383s1.573.626 2.12 1.078c.444.382.752.8.992 1.286.205.487.341 1.009.341 1.6v5.772c0 .347.137.695.377.938.239.244.547.383.923.383h.479c.341 0 .683-.14.923-.383.239-.243.376-.556.376-.938v-5.772c0-2.052-.82-3.93-2.394-5.285-1.573-1.357-3.932-2.191-6.975-2.191H81.018c-.342 0-.684.14-.923.382-.24.244-.376.557-.376.94V28.63c0 2.052.82 3.93 2.393 5.285 1.573 1.356 3.932 2.19 6.975 2.19h14.292c.137 0 .273.035.41.07.137.07.24.14.342.244l1.573 1.6 1.573 1.599c.239.243.58.382.923.382.342 0 .65-.14.923-.382l.171-.174.17-.174c.24-.244.377-.591.377-.939s-.137-.695-.376-.939l-1.88-1.912-1.95-1.878zm45.61-18.567c-2.77 0-4.786.626-6.086 1.669-1.299 1.043-1.914 2.468-1.914 4.033v.626c0 1.565.615 2.99 1.914 4.033 1.3 1.043 3.317 1.67 6.086 1.67H159.931c.957 0 1.778.104 2.496.278.718.173 1.3.417 1.71.764.239.21.444.418.546.73.103.314.171.696.171 1.183 0 .521-.068.904-.17 1.182-.103.278-.308.522-.548.73-.41.313-.991.591-1.71.765-.717.174-1.572.278-2.495.278h-10.257c-.582 0-1.163-.104-1.676-.347-.547-.209-1.025-.522-1.436-.94l-.342-.347-.342-.348c-.273-.243-.615-.382-.923-.382-.342 0-.684.139-.923.417l-.137.174-.136.174c-.24.278-.377.626-.342.939 0 .347.136.66.41.939l.342.347.342.348c.718.695 1.538 1.217 2.427 1.565.89.347 1.847.556 2.804.556h10.257c2.77 0 4.787-.626 6.086-1.67 1.3-1.042 1.915-2.468 1.915-4.032v-.626c0-1.565-.615-2.99-1.915-4.034-1.299-1.043-3.316-1.669-6.086-1.669h-8.684c-.958 0-1.778-.104-2.496-.278-.718-.174-1.3-.417-1.71-.765-.24-.208-.444-.417-.547-.73-.137-.313-.17-.695-.17-1.182 0-.522.068-.904.17-1.182.137-.313.308-.522.547-.73.41-.313.992-.592 1.71-.765.718-.174 1.573-.279 2.496-.279h9.436c.548 0 1.129.105 1.642.313.513.209.991.487 1.402.87l.444.382.444.382c.274.244.616.348.958.348.342-.035.65-.174.889-.452l.137-.174.136-.174c.24-.278.342-.625.342-.973-.034-.348-.17-.66-.444-.904l-.445-.383-.444-.382c-.684-.626-1.505-1.148-2.36-1.46-.854-.348-1.777-.522-2.735-.522H156l-4.753.035zM71 16.356v18.428c0 .383.137.696.376.94.24.243.547.382.923.382h.411c.376 0 .683-.14.923-.383.239-.243.376-.556.376-.939V16.356c0-.382-.137-.695-.376-.939-.24-.243-.547-.382-.923-.382h-.411c-.376 0-.684.139-.923.382-.24.244-.376.557-.376.94z"></path>
                        </g>
                    </g>
                </g>
            </svg>
            <p class="age-verification-title">
                Introduza a sua data de nascimento para confirmar que é um utilizador adulto de produtos de tabaco ou nicotina.
            </p>
            <div class="age-selectors">
                <select class="age-select" id="monthSelect">
                    <option value="">MÊS *</option>
                </select>
                <select class="age-select" id="yearSelect">
                    <option value="">ANO *</option>
                </select>
            </div>
            <button class="age-verify-button" id="confirmAgeBtn" disabled>CONFIRMAR</button>
            <p class="age-verification-disclaimer">
                Este website contém informação sobre os nossos produtos sem fumo. Precisamos de conhecer a sua idade para assegurar que é um adulto que de outra forma continuaria a fumar ou a usar produtos com nicotina. Os nossos produtos sem fumo não são uma alternativa para deixar de fumar nem foram concebidos como meios de cessação. Não estão isentos de riscos, contêm nicotina que cria dependência e destinam-se exclusivamente a adultos.<br>
                Consulte a pagina de Informação Importante no site para mais informação sobre os riscos.
            </p>
        </div>
    </div>

    <header class="hero-header">
        <div class="hero-content">
            <H2>NOVO</H2>
            <h1 class="hero-title">IQOS ILUMA i PRIME</h1>
            <div class="hero-model">
                <model-viewer 
                    src="modelo3d/modelo.glb"
                    camera-controls
                    auto-rotate
                    rotation-per-second="30deg"
                    interaction-prompt="none"
                    shadow-intensity="1"
                    exposure="1.2"
                    loading-progress="manual"
                    preload
                    loading-mode="eager"
                    draco-decoder-path="https://www.gstatic.com/draco/versioned/decoders/1.5.6/"
                    style="width: 100%; height: 60vh; background-color: transparent;">
                </model-viewer>
            </div>
            <p class="hero-description">A inovação atinge um novo patamar</p>
            <button class="cta-button" onclick="scrollToSelector()">EXPERIÊNCIA IMERSIVA</button>
        </div>
    </header>
    <div class="container">
        <h2 class="selector-title">ESCOLHE A MÁQUINA E VIVE UMA EXPERIÊNCIA IMERSIVA</h2>
        
        <!-- Seletor de Modelos -->
        <div id="model-selector" class="model-selector">
            <button class="model-button active" data-model="iprimeaqua_1">IQOS ILUMA</button>
            <button class="model-button" data-model="iprimeaqua_2">IQOS ILUMA ONE</button>
            <button class="model-button" data-model="iprimeaqua_3">IQOS ILUMA PRIME</button>
        </div>

        <!-- Botões AR -->
        <div class="ar-buttons">
            <button id="ar-button-android" class="ar-button" style="display: none;">
                Experiência com Realidade Aumentada
            </button>
            <button id="ar-button-ios" class="ar-button" style="display: none;">
                Experiência com Realidade Aumentada
            </button>
        </div>

        <!-- Visualizador 3D -->
        <div class="model-container">
            <model-viewer
                id="model-viewer"
                src="modelo3d/iprimeaqua_1.glb"
                ios-src="modelo3d/iprimeaqua_1.usdz"
                alt="Modelo 3D"
                ar
                ar-modes="scene-viewer webxr quick-look"
                ar-scale="fixed"
                ar-placement="floor"
                camera-controls
                auto-rotate
                shadow-intensity="1"
                shadow-softness="0"
                exposure="1"
                environment-image="neutral"
                interaction-prompt="none"
                scale="7 7 7"
                min-camera-orbit="auto auto 5%"
                max-camera-orbit="auto auto 100%"
                camera-orbit="0deg 75deg 105%"
                loading="eager"
                loading-progress="none"
                preload
                loading-mode="eager"
                draco-decoder-path="https://www.gstatic.com/draco/versioned/decoders/1.5.6/"
                style="width: 100%; height: 100%; background-color: #ffffff;">

                <!-- Hotspots -->
                <button class="hotspot" slot="hotspot-1" data-position="0.1 0.2 0.1" data-normal="0 1 0" data-visibility-attribute="visible">
                    <div class="hotspot-dot"></div>
                    <div class="hotspot-label">Tela OLED</div>
                </button>

                <button class="hotspot" slot="hotspot-2" data-position="-0.1 0.15 0" data-normal="0 1 0" data-visibility-attribute="visible">
                    <div class="hotspot-dot"></div>
                    <div class="hotspot-label">Bateria</div>
                </button>

                <button class="hotspot" slot="hotspot-3" data-position="0 0.25 0.1" data-normal="0 1 0" data-visibility-attribute="visible">
                    <div class="hotspot-dot"></div>
                    <div class="hotspot-label">Câmara de Aquecimento</div>
                </button>

                <!-- Aviso AR -->
                <div class="ar-placement-prompt" slot="ar-prompt">
                    Pouse o seu IQOS clicando no ecrã
                </div>

                <!-- Instruções AR -->
                <div class="ar-instructions" slot="ar-overlay">
                    <div class="instruction-item">
                        <span class="instruction-icon">👆</span>
                        <span>Toque para colocar o modelo</span>
                    </div>
                    <div class="instruction-item">
                        <span class="instruction-icon">✋</span>
                        <span>Arraste com um dedo para mover o modelo</span>
                    </div>
                    <div class="instruction-item">
                        <span class="instruction-icon">↻</span>
                        <span>Gire com dois dedos para rodar</span>
                    </div>
                </div>

                <div class="progress-bar hide" slot="progress-bar">
                    <div class="update-bar"></div>
                </div>
            </model-viewer>

            <div class="controls">
                <button id="rotate-left" title="Girar Esquerda">↺</button>
                <button id="rotate-right" title="Girar Direita">↻</button>
                <button id="zoom-in" title="Aproximar">+</button>
                <button id="zoom-out" title="Afastar">−</button>
            </div>
        </div>

        <div class="ar-modal" id="arModal">
            <div class="ar-modal-content">
                <h2>Como usar a Realidade Aumentada</h2>
                <div class="ar-instructions-list">
                    <div class="instruction-item">
                        <span class="instruction-icon">👆</span>
                        <span>Toque para colocar o modelo</span>
                    </div>
                    <div class="instruction-item">
                        <span class="instruction-icon">✋</span>
                        <span>Arraste com um dedo para mover o modelo</span>
                    </div>
                    <div class="instruction-item">
                        <span class="instruction-icon">↻</span>
                        <span>Gire com dois dedos para rodar</span>
                    </div>
                    <div class="instruction-item">
                        <span class="instruction-icon">📍</span>
                        <span>O modelo ficará fixo onde foi colocado. Se mover a câmera para longe, volte ao local inicial ou feche e abra novamente para reposicionar</span>
                    </div>
                </div>
                <button id="startAR" class="ar-start-button">Iniciar Experiência AR</button>
            </div>
        </div>
    </div>

    <footer class="footer">
        <p class="footer-warning">
            <b>ESTE PRODUTO NÃO É ISENTO DE RISCO E CONTÉM NICOTINA, UMA SUBSTÂNCIA QUE CRIA DEPENDÊNCIA. DESTINADO APENAS A FUMADORES ADULTOS.</b>
        </p>
        <p class="footer-copyright">
            © 2025 Philip Morris Products SA. Todos os direitos reservados.
        </p>
    </footer>

    <script>
        // Verificação de Idade
        document.addEventListener('DOMContentLoaded', function() {
            const monthSelect = document.getElementById('monthSelect');
            const yearSelect = document.getElementById('yearSelect');
            const confirmBtn = document.getElementById('confirmAgeBtn');
            const modal = document.getElementById('ageVerificationModal');

            // Verificar se já foi verificado antes
            const ageVerified = localStorage.getItem('ageVerified');
            if (ageVerified === 'true') {
                modal.style.display = 'none';
            }

            // Preencher meses
            const months = [
                'Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
                'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
            ];
            months.forEach((month, index) => {
                const option = document.createElement('option');
                option.value = index + 1;
                option.textContent = month;
                monthSelect.appendChild(option);
            });

            // Preencher anos (últimos 120 anos)
            const currentYear = new Date().getFullYear();
            for (let year = currentYear; year >= currentYear - 120; year--) {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            }

            // Função para verificar idade
            function checkAge() {
                const month = parseInt(monthSelect.value);
                const year = parseInt(yearSelect.value);
                
                if (month && year) {
                    const birthDate = new Date(year, month - 1);
                    const today = new Date();
                    let age = today.getFullYear() - birthDate.getFullYear();
                    const m = today.getMonth() - birthDate.getMonth();
                    
                    if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                        age--;
                    }
                    
                    confirmBtn.disabled = age < 18;
                } else {
                    confirmBtn.disabled = true;
                }
            }

            // Adicionar event listeners
            monthSelect.addEventListener('change', checkAge);
            yearSelect.addEventListener('change', checkAge);
            
            // Event listener para o botão confirmar
            confirmBtn.addEventListener('click', function(event) {
                event.preventDefault();
                console.log('Botão clicado');
                localStorage.setItem('ageVerified', 'true');
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });

            // Verificação inicial
            if (localStorage.getItem('ageVerified') === 'true') {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            } else {
                document.body.style.overflow = 'hidden';
            }
        });

        // Função para scroll suave
        function scrollToSelector() {
            document.getElementById('model-selector').scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }

        // Pré-carregar modelos
        const modelFiles = ['iprimeaqua_1', 'iprimeaqua_2', 'iprimeaqua_3'];
        const preloadedModels = new Map();

        async function preloadModels() {
            for (const modelName of modelFiles) {
                try {
                    const response = await fetch(`modelo3d/${modelName}.glb`);
                    const blob = await response.blob();
                    const url = URL.createObjectURL(blob);
                    preloadedModels.set(modelName, url);
                } catch (error) {
                    console.error(`Erro ao pré-carregar modelo ${modelName}:`, error);
                }
            }
        }

        // Iniciar pré-carregamento quando a página carregar
        window.addEventListener('load', preloadModels);

        document.addEventListener('DOMContentLoaded', function() {
            const modelViewer = document.querySelector('#model-viewer');
            const modelButtons = document.querySelectorAll('.model-button');
            const arButtonAndroid = document.getElementById('ar-button-android');
            const arButtonIOS = document.getElementById('ar-button-ios');
            
            // Detectar dispositivo
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            const isAndroid = /Android/i.test(navigator.userAgent);

            // Função para ativar AR no Android
            async function activateARAndroid() {
                try {
                    await modelViewer.activateAR();
                } catch (error) {
                    console.error('Erro ao ativar AR:', error);
                    // Fallback para scene-viewer se webxr falhar
                    const modelName = modelViewer.src.split('/').pop().split('.')[0];
                    window.location.href = `intent://arvr.google.com/scene-viewer/1.0?file=${window.location.origin}/modelo3d/${modelName}.glb&mode=ar_preferred&resizable=false&scale=7.0#Intent;scheme=https;package=com.google.android.googlequicksearchbox;action=android.intent.action.VIEW;S.browser_fallback_url=https://developers.google.com/ar;end;`;
                }
            }

            // Função para ativar AR no iOS
            async function activateARiOS() {
                try {
                    const modelName = modelViewer.src.split('/').pop().split('.')[0];
                    window.location.href = `modelo3d/${modelName}.usdz`;
                } catch (error) {
                    console.error('Erro ao ativar AR no iOS:', error);
                }
            }

            // Configurar modal AR
            const arModal = document.getElementById('arModal');
            const startARButton = document.getElementById('startAR');

            function showARInstructions() {
                arModal.style.display = 'flex';
            }

            function hideARInstructions() {
                arModal.style.display = 'none';
            }

            startARButton.addEventListener('click', () => {
                hideARInstructions();
                activateARAndroid();
            });

            // Configurar botões AR baseado no dispositivo
            if (isIOS) {
                arButtonIOS.style.display = 'block';
                arButtonAndroid.style.display = 'none';
                arButtonIOS.onclick = activateARiOS;
            } else if (isAndroid) {
                arButtonAndroid.style.display = 'block';
                arButtonIOS.style.display = 'none';
                arButtonAndroid.onclick = showARInstructions;
            }
            
            // Configurar seletor de modelos
            modelButtons.forEach(button => {
                button.addEventListener('click', async () => {
                    // Remover classe active de todos os botões
                    modelButtons.forEach(btn => btn.classList.remove('active'));
                    // Adicionar classe active ao botão clicado
                    button.classList.add('active');
                    
                    // Atualizar modelo usando o modelo pré-carregado se disponível
                    const modelName = button.getAttribute('data-model');
                    if (preloadedModels.has(modelName)) {
                        modelViewer.src = preloadedModels.get(modelName);
                    } else {
                        modelViewer.src = `modelo3d/${modelName}.glb`;
                    }
                    modelViewer.iosSrc = `modelo3d/${modelName}.usdz`;
                    
                    // Mostrar botão AR apropriado
                    if (isIOS) {
                        arButtonIOS.style.display = 'block';
                        arButtonIOS.onclick = () => {
                            window.location.href = `modelo3d/${modelName}.usdz`;
                        };
                    } else if (isAndroid) {
                        arButtonAndroid.style.display = 'block';
                        arButtonAndroid.onclick = showARInstructions;
                    }
                    
                    // Resetar câmera
                    modelViewer.cameraOrbit = '0deg 75deg 105%';
                    modelViewer.fieldOfView = '30deg';
                });
            });

            // Configurar botões de controle
            const rotateLeftBtn = document.getElementById('rotate-left');
            const rotateRightBtn = document.getElementById('rotate-right');
            const zoomInBtn = document.getElementById('zoom-in');
            const zoomOutBtn = document.getElementById('zoom-out');

            let currentRotation = 0;
            const rotationStep = 30;
            let currentZoom = 105;
            const zoomStep = 10;

            rotateLeftBtn.addEventListener('click', () => {
                currentRotation -= rotationStep;
                modelViewer.cameraOrbit = `${currentRotation}deg 75deg ${currentZoom}%`;
            });

            rotateRightBtn.addEventListener('click', () => {
                currentRotation += rotationStep;
                modelViewer.cameraOrbit = `${currentRotation}deg 75deg ${currentZoom}%`;
            });

            zoomInBtn.addEventListener('click', () => {
                currentZoom = Math.max(currentZoom - zoomStep, 50);
                modelViewer.cameraOrbit = `${currentRotation}deg 75deg ${currentZoom}%`;
            });

            zoomOutBtn.addEventListener('click', () => {
                currentZoom = Math.min(currentZoom + zoomStep, 150);
                modelViewer.cameraOrbit = `${currentRotation}deg 75deg ${currentZoom}%`;
            });

            // Atualizar hotspots quando o modelo carregar
            modelViewer.addEventListener('load', () => {
                const hotspots = document.querySelectorAll('.hotspot');
                hotspots.forEach(hotspot => {
                    hotspot.style.opacity = '1';
                    hotspot.style.visibility = 'visible';
                });
            });
        });
    </script>
</body>
</html> 